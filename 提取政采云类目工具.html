<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ”¿é‡‡äº‘ç±»ç›®æ•°æ®æå–å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1890ff;
            margin-bottom: 10px;
        }

        .step {
            background: #e6f7ff;
            border-left: 4px solid #1890ff;
            padding: 15px;
            margin: 20px 0;
        }

        button {
            background: #52c41a;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 0;
        }

        button:hover {
            background: #389e0d;
        }

        #code {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .success {
            color: #52c41a;
            font-weight: bold;
        }

        .warning {
            color: #fa8c16;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="card">
        <h1>ğŸ” æ”¿é‡‡äº‘ç±»ç›®æ•°æ®æå–å·¥å…·</h1>
        <p>è¿™ä¸ªå·¥å…·å¯ä»¥å¸®æ‚¨ä»æ”¿é‡‡äº‘é¡µé¢å†…å­˜ä¸­æå–å®Œæ•´çš„ç±»ç›®æ•°æ®ã€‚</p>

        <div class="step">
            <strong>ğŸ“Œ ä½¿ç”¨æ­¥éª¤ï¼š</strong><br>
            1. ç¡®ä¿æ‚¨å·²ç»åœ¨æµè§ˆå™¨ä¸­<span class="warning">æ‰“å¼€äº†æ”¿é‡‡äº‘çš„ç±»ç›®é€‰æ‹©é¡µé¢</span><br>
            2. ç‚¹å‡»ä¸‹æ–¹çš„<span class="success">"ç”Ÿæˆæå–ä»£ç "</span>æŒ‰é’®<br>
            3. å¤åˆ¶ç”Ÿæˆçš„ä»£ç <br>
            4. åˆ‡æ¢åˆ°æ”¿é‡‡äº‘é¡µé¢ï¼ŒæŒ‰ <kbd>F12</kbd> æ‰“å¼€å¼€å‘è€…å·¥å…·<br>
            5. åœ¨ Consoleï¼ˆæ§åˆ¶å°ï¼‰æ ‡ç­¾ä¸­ï¼Œ<span class="warning">ç›´æ¥æŒ‰ Ctrl+V ç²˜è´´</span>ï¼ˆè·³è¿‡"å…è®¸ç²˜è´´"çš„æç¤ºï¼‰<br>
            6. æŒ‰ <kbd>Enter</kbd> æ‰§è¡Œ<br>
            7. å¦‚æœæˆåŠŸï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸‹è½½ JSON æ–‡ä»¶
        </div>

        <button onclick="generateCode()">ğŸš€ ç”Ÿæˆæå–ä»£ç </button>
        <button onclick="copyCode()" id="copyBtn" style="display:none; background:#1890ff;">ğŸ“‹ å¤åˆ¶ä»£ç </button>

        <div id="code" style="display:none;"></div>

        <div id="result" style="margin-top:20px;"></div>
    </div>

    <script>
        let generatedCode = '';

        function generateCode() {
            generatedCode = `
(function() {
    console.log('ğŸ” å¼€å§‹æ‰«æå†…å­˜...');
    let found = null;
    let source = '';

    // æ‰«æ window
    for (let key in window) {
        try {
            if (typeof window[key] === 'object' && window[key]) {
                const str = JSON.stringify(window[key]);
                if (str.includes('children') && str.includes('name') && str.includes('id') && str.length > 5000) {
                    found = window[key];
                    source = 'window.' + key;
                    break;
                }
            }
        } catch(e) {}
    }

    // æ‰«æ localStorage
    if (!found) {
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            const val = localStorage.getItem(key);
            if (val && val.includes('children') && val.includes('name') && val.length > 5000) {
                try {
                    found = JSON.parse(val);
                    source = 'localStorage.' + key;
                    break;
                } catch(e) {}
            }
        }
    }

    // æ‰«æ sessionStorage
    if (!found) {
        for (let i = 0; i < sessionStorage.length; i++) {
            const key = sessionStorage.key(i);
            const val = sessionStorage.getItem(key);
            if (val && val.includes('children') && val.includes('name') && val.length > 5000) {
                try {
                    found = JSON.parse(val);
                    source = 'sessionStorage.' + key;
                    break;
                } catch(e) {}
            }
        }
    }

    if (found) {
        console.log('âœ… æˆåŠŸæ‰¾åˆ°ç±»ç›®æ•°æ®ï¼æ¥æºï¼š' + source);
        console.log('æ•°æ®é¢„è§ˆï¼š', found);
        
        // ä¸‹è½½æ–‡ä»¶
        const blob = new Blob([JSON.stringify(found, null, 2)], {type: "application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'zcy_categories_' + new Date().getTime() + '.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        console.log('âœ… æ–‡ä»¶å·²å¼€å§‹ä¸‹è½½ï¼');
        alert('âœ… æˆåŠŸæå–ç±»ç›®æ•°æ®ï¼\\næ¥æºï¼š' + source + '\\næ–‡ä»¶å·²å¼€å§‹ä¸‹è½½ã€‚');
    } else {
        console.log('âŒ æœªæ‰¾åˆ°ç±»ç›®æ•°æ®');
        alert('âŒ æœªåœ¨å†…å­˜ä¸­æ‰¾åˆ°ç±»ç›®æ•°æ®ã€‚\\n\\nå¯èƒ½çš„åŸå› ï¼š\\n1. ç±»ç›®é€‰æ‹©å™¨æœªåŠ è½½å®Œæˆ\\n2. æ•°æ®ç»“æ„å‘ç”Ÿå˜åŒ–\\n\\nè¯·ç¡®ä¿é¡µé¢å·²å®Œå…¨åŠ è½½ï¼Œç„¶åé‡è¯•ã€‚');
    }
})();
            `.trim();

            document.getElementById('code').style.display = 'block';
            document.getElementById('code').textContent = generatedCode;
            document.getElementById('copyBtn').style.display = 'inline-block';
            document.getElementById('result').innerHTML = '<p class="success">âœ… ä»£ç å·²ç”Ÿæˆï¼è¯·æŒ‰ç…§ä¸Šæ–¹æ­¥éª¤æ“ä½œã€‚</p>';
        }

        function copyCode() {
            navigator.clipboard.writeText(generatedCode).then(() => {
                alert('âœ… ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\\nç°åœ¨è¯·åˆ‡æ¢åˆ°æ”¿é‡‡äº‘é¡µé¢ï¼ŒæŒ‰ F12 æ‰“å¼€æ§åˆ¶å°ï¼Œç²˜è´´å¹¶æ‰§è¡Œã€‚');
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰ä¸­ä»£ç å¤åˆ¶ï¼š' + err);
            });
        }
    </script>
</body>

</html>